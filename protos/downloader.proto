syntax = "proto3";

package downloader;

service DownloaderService {
  rpc DownloadMedia (DownloadRequest) returns (stream DownloadResponse) {}
  
  // Новые методы
  rpc GetVersion (Empty) returns (VersionResponse) {}
  rpc UpdateYtdlp (Empty) returns (UpdateResponse) {}
}

// Пустое сообщение для запросов без параметров
message Empty {}

message VersionResponse {
  string version = 1;
}

message UpdateResponse {
  bool success = 1;
  string message = 2;
  string new_version = 3;
}

// ... (остальные сообщения DownloadRequest/Response оставьте как были) ...
message DownloadRequest {
  string url = 1;
  bool is_music = 2;
  int32 video_height = 3;
  string cookies_content = 4;
}

message Metadata {
  string title = 1;
  string uploader = 2;
  string webpage_url = 3;
  int32 duration = 4;
  int32 width = 5;
  int32 height = 6;
  string filename = 7;
}

message DownloadResponse {
  oneof payload {
    Metadata metadata = 1;
    bytes file_chunk = 2;
    bytes thumbnail_chunk = 3;
  }
}